//////////////////////////////////////////////////////////////////////////
// 이것 저것 잡다한 함수 모아놓은 class
// 최종 수정 [4/5/2009 OSC]
// static LPCTSTR GetLocalIpAddress() 함수 추가
//////////////////////////////////////////////////////////////////////////

#pragma once

static HANDLE hSleepTimeEvent = NULL;

class CEtc
{
public:
	CEtc(void);
	~CEtc(void);

	//////////////////////////////////////////////////////////////////////////
	// 특정 컨트롤 영역 Capture 함수(Screen Capture 응용)
	// 파일 확장명에 따라 자동으로 File Format 변경됨
	// *.bmp(BMP), *.png(PNG), *.jpg(JPEG), *.gif(GIF)
	// ex) CEtc::CaptureScreen(this.m_hWnd, _T("D:\\a.jpg"));
	static void CaptureScreen(HWND hScreen, LPCTSTR szFileName );
	//////////////////////////////////////////////////////////////////////////

	//////////////////////////////////////////////////////////////////////////
	// 반올림 함수
	// 소수점 nPos째 자리를 반올림 한다
	//#define round(dTemp) (long(dTemp+(dTemp>0? .5:-.5)))
	static double Round(double dValue, int nPos = 1);
	//////////////////////////////////////////////////////////////////////////

	//////////////////////////////////////////////////////////////////////////
	// 로그함수	
	// base가 몇승일 때 dValue가 되는지 승을 알아오는 함수
	static double Logbase(double dValue, double base);
	//////////////////////////////////////////////////////////////////////////

	//////////////////////////////////////////////////////////////////////////
	// Sleep() 대용 함수
	// 검증용
	// CreateSleepTimeEvent();로 이벤트 선언후
	// 실제 Sleep()을 쓸 곳에 SleepTime()을 대신 사용
	// 이후 ClCloseSleepTimeEvent()로 이벤트를 종료한다.
	static void CreateSleepTimeEvent();
	static void SleepTime(DWORD dwMillisecond);
	static void CloseSleepTimeEvent();
	//////////////////////////////////////////////////////////////////////////

	//////////////////////////////////////////////////////////////////////////
	// Encoder Position Check용 함수
	static BOOL CheckPosition(double dDefaultPos, double dNowPos, double dCheckLimit = 0.05); /* ±0.01mm이상 차이나면 틀리다고 간주 */
	//////////////////////////////////////////////////////////////////////////

	//////////////////////////////////////////////////////////////////////////
	// Local IP Address 얻어오는 함수
	static LPCTSTR GetLocalIPAddress();
	//////////////////////////////////////////////////////////////////////////

	static LPCTSTR GetDeviceIPAddress(LPCTSTR szDeviceName);
	static HRESULT GetConnectionIPAddress(LPCTSTR szConnectionName);
};
